#:kivy 2.2.0
#:import dp kivy.metrics.dp
#


# ======================
# SCREENMANAGER
# ======================
ScreenManager:
    MenuScreen:
    CreatePlayerScreen:
    PlayerSelectScreen:
    GameScreen:
    HistoryScreen:
    StatsScreen:
    AboutScreen:
    OptionsScreen:


# ======================
# MENUSCREEN 
# ======================
<MenuScreen>:
    name: "menu"
    
    BoxLayout:
    	orientation: "vertical"
    	#size_hint: (None, None)

	    BoxLayout:
	        orientation: "vertical"
	        padding: dp(20)
	        spacing: dp(15)
	        size_hint: (1.0, 0.3)
	        
	        Image:
	        	source: "data/icon_1024.png"
	        	size_hint: (1.0, 1.0)
	        	#height: dp(50)
	        Label:
	            text: "Domino Scorebook"
	            font_size: "28sp"
	            size_hint_y: 0.6
	            height: dp(40)
	
		BoxLayout:
			orientation:"vertical"
			padding: dp(20)
        	spacing: dp(15)
        	size_hint: (1.0, 0.5)
		
	        Button:
	            text: "Start Game"
	            size_hint: (0.3, None)
	            height: dp(30)
	            pos_hint: {"center_x": 0.5}
	            on_release: root.manager.current = "select"
	            
		    BoxLayout:
				orientation:"horizontal"
				padding: dp(20)
	        	spacing: dp(15)
		        
		        Button:
		        	text: "Options"
		        	on_release: root.manager.current = "options"
		        Button:
		            text: "Game History"
		            on_release: root.manager.current = "history"
		        Button:
		            text: "Player Stats"
		            on_release: root.manager.current = "stats"
        
	    BoxLayout:
			orientation:"horizontal"
			padding: dp(20)
	        spacing: dp(15)
	        
	        Button:
	        	text: "About"
	        	size_hint: (0.3, None)
	        	height: dp(50)
	        	on_release: root.manager.current = "about"
	        
	        Button:
	        	text: "Exit"
	        	size_hint: (0.3, None)
	        	height: dp(50)
	        	on_release: app.stop()


# ======================
# CREATEPLAYERSCREEN 
# ======================
<CreatePlayerScreen>:
    name: "create"

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(15)

        Label:
            text: "Create Player"
            font_size: "24sp"
            size_hint_y: None
            height: dp(50)

        TextInput:
            id: player_name_input
            hint_text: "Player name"
            multiline: False

        Button:
            text: "Save Player"
            size_hint_y: None
            height: dp(50)
            on_release: root.save_player(player_name_input.text)

        Button:
            text: "Back"
            size_hint_y: None
            height: dp(50)
            on_release: root.manager.current = "menu"


# ======================
# PLAYERSELECTSCREEN 
# ======================
<PlayerSelectScreen>:
    name: "select"

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Label:
            text: "Select Players"
            font_size: "24sp"
            size_hint_y: None
            height: dp(50)

        ScrollView:
            GridLayout:
                id: player_list
                cols: 1
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

        Button:
            text: "Start Game"
            size_hint_y: None
            height: dp(50)
            on_release:
                app.start_game([btn.text for btn in player_list.children if btn.state == "down"])

        Button:
            text: "Back"
            size_hint_y: None
            height: dp(50)
            on_release: root.manager.current = "menu"


# ======================
# GAMESCREEN 
# ======================
<GameScreen>:
    name: "game"

    BoxLayout:
        orientation: "vertical"
        padding: dp(10)
        spacing: dp(10)

        Label:
            text: "Game In Progress"
            font_size: "22sp"
            size_hint_y: None
            height: dp(40)

        ScrollView:
            GridLayout:
                id: player_container
                cols: 1
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

        Button:
            text: "End Game"
            size_hint_y: None
            height: dp(50)
            on_release: root.end_game()


# ======================
# HISTORYSCREEN
# ======================
<HistoryScreen>:
    name: "history"

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Label:
            text: "Game History"
            font_size: "24sp"
            size_hint_y: None
            height: dp(50)

        ScrollView:
            GridLayout:
                id: history_list
                cols: 1
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

        Button:
            text: "Back"
            size_hint_y: None
            height: dp(50)
            on_release: root.manager.current = "menu"


# ======================
# STATSSCREEN
# ======================
<StatsScreen>:
    name: "stats"

    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Label:
            text: "Player Stats (Coming Soon)"
            font_size: "22sp"

        Button:
            text: "Back"
            size_hint_y: None
            height: dp(50)
            on_release: root.manager.current = "menu"


# ======================
# ABOUTSCREEN 
# ======================
<AboutScreen>:
	name: "about"
	
	BoxLayout:
		orientation: "vertical"
		padding: dp(20)
		spacing: dp(10)
		
		Label:
            text: "About Screen (Coming Soon)"
            font_size: "22sp"

        Button:
            text: "Back"
            size_hint_y: None
            height: dp(50)
            on_release: root.manager.current = "menu"


# ======================
# OPTIONSSCREEN 
# ======================
<OptionsScreen>:
	name: "options"
	
	BoxLayout:
		orientation: "vertical"
		padding: dp(20)
		spacing: dp(10)
		
		BoxLayout:
			orientation: "horizontal"
			padding: dp(20)
			spacing: dp(10)
			
			Button:
				text: "Import Saves"
				size_hint_y: None 
				height: dp(50)
				on_release: root.import_saves()
			
			Button:
				text: "Export Saves"
				size_hint_y: None 
				height: dp(50)
				on_release: root.export_saves()
		
		Button:
            text: "Back"
            size_hint_y: None
            height: dp(50)
            on_release: root.manager.current = "menu"
